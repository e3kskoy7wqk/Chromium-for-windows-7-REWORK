diff --git a/third_party/boringssl/src/crypto/thread_win.cc b/third_party/boringssl/src/crypto/thread_win.cc
index c8e19f51f..45011650e 100644
--- a/third_party/boringssl/src/crypto/thread_win.cc
+++ b/third_party/boringssl/src/crypto/thread_win.cc
@@ -82,7 +82,7 @@ void CRYPTO_STATIC_MUTEX_unlock_write(struct CRYPTO_STATIC_MUTEX *lock) {
   // SRWLOCKs require no cleanup.
 }
 
-static SRWLOCK g_destructors_lock = SRWLOCK_INIT;
+static CRITICAL_SECTION g_destructors_lock;
 static thread_local_destructor_t g_destructors[NUM_OPENSSL_THREAD_LOCALS];
 
 static CRYPTO_once_t g_thread_local_init_once = CRYPTO_ONCE_INIT;
@@ -90,6 +90,10 @@ static DWORD g_thread_local_key;
 static int g_thread_local_failed;
 
 static void thread_local_init(void) {
+  if (!InitializeCriticalSectionAndSpinCount(&g_destructors_lock, 0x400)) {
+    g_thread_local_failed = 1;
+    return;
+  }
   g_thread_local_key = TlsAlloc();
   g_thread_local_failed = (g_thread_local_key == TLS_OUT_OF_INDEXES);
 }
@@ -117,11 +121,12 @@ static void NTAPI thread_local_destructor(PVOID module, DWORD reason,
 
   thread_local_destructor_t destructors[NUM_OPENSSL_THREAD_LOCALS];
 
-  AcquireSRWLockExclusive(&g_destructors_lock);
+  EnterCriticalSection(&g_destructors_lock);
   OPENSSL_memcpy(destructors, g_destructors, sizeof(destructors));
-  ReleaseSRWLockExclusive(&g_destructors_lock);
+  LeaveCriticalSection(&g_destructors_lock);
 
-  for (unsigned i = 0; i < NUM_OPENSSL_THREAD_LOCALS; i++) {
+  unsigned i;
+  for (i = 0; i < NUM_OPENSSL_THREAD_LOCALS; i++) {
     if (destructors[i] != nullptr) {
       destructors[i](pointers[i]);
     }
@@ -245,9 +250,9 @@ int CRYPTO_set_thread_local(thread_local_data_t index, void *value,
     }
   }
 
-  AcquireSRWLockExclusive(&g_destructors_lock);
+  EnterCriticalSection(&g_destructors_lock);
   g_destructors[index] = destructor;
-  ReleaseSRWLockExclusive(&g_destructors_lock);
+  LeaveCriticalSection(&g_destructors_lock);
 
   pointers[index] = value;
   return 1;
