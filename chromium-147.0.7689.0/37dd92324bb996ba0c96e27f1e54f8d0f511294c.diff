diff --git a/base/files/file_win.cc b/base/files/file_win.cc
index 82cd7e8b429dc..537d3a4ce6799 100644
--- a/base/files/file_win.cc
+++ b/base/files/file_win.cc
@@ -13,6 +13,85 @@
 #include "base/strings/string_util.h"
 #include "base/threading/scoped_blocking_call.h"
 
+#pragma comment(lib, "ntdll.lib")
+
+#ifdef __cplusplus
+extern "C" {
+#endif // __cplusplus
+typedef LONG NTSTATUS;
+
+typedef struct _IO_STATUS_BLOCK {
+    union {
+        NTSTATUS Status;
+        PVOID Pointer;
+    };
+
+    ULONG_PTR Information;
+} IO_STATUS_BLOCK, *PIO_STATUS_BLOCK;
+
+typedef enum _FILE_INFORMATION_CLASS {
+// end_wdm
+    FileDirectoryInformation         = 1,
+    FileFullDirectoryInformation,   // 2
+    FileBothDirectoryInformation,   // 3
+    FileBasicInformation,           // 4  wdm
+    FileStandardInformation,        // 5  wdm
+    FileInternalInformation,        // 6
+    FileEaInformation,              // 7
+    FileAccessInformation,          // 8
+    FileNameInformation,            // 9
+    FileRenameInformation,          // 10
+    FileLinkInformation,            // 11
+    FileNamesInformation,           // 12
+    FileDispositionInformation,     // 13
+    FilePositionInformation,        // 14 wdm
+    FileFullEaInformation,          // 15
+    FileModeInformation,            // 16
+    FileAlignmentInformation,       // 17
+    FileAllInformation,             // 18
+    FileAllocationInformation,      // 19
+    FileEndOfFileInformation,       // 20 wdm
+    FileAlternateNameInformation,   // 21
+    FileStreamInformation,          // 22
+    FilePipeInformation,            // 23
+    FilePipeLocalInformation,       // 24
+    FilePipeRemoteInformation,      // 25
+    FileMailslotQueryInformation,   // 26
+    FileMailslotSetInformation,     // 27
+    FileCompressionInformation,     // 28
+    FileObjectIdInformation,        // 29
+    FileCompletionInformation,      // 30
+    FileMoveClusterInformation,     // 31
+    FileQuotaInformation,           // 32
+    FileReparsePointInformation,    // 33
+    FileNetworkOpenInformation,     // 34
+    FileAttributeTagInformation,    // 35
+    FileTrackingInformation,        // 36
+    FileIdBothDirectoryInformation, // 37
+    FileIdFullDirectoryInformation, // 38
+    FileValidDataLengthInformation, // 39
+    FileShortNameInformation,       // 40
+    FileMaximumInformation
+// begin_wdm
+} FILE_INFORMATION_CLASS, *PFILE_INFORMATION_CLASS;
+
+#define NT_SUCCESS(Status)      ((NTSTATUS)(Status) >= 0)
+#define STATUS_SUCCESS          ((NTSTATUS)0x00000000L)
+
+NTSYSCALLAPI
+NTSTATUS
+NTAPI
+NtSetInformationFile(
+    IN HANDLE FileHandle,
+    OUT PIO_STATUS_BLOCK IoStatusBlock,
+    IN PVOID FileInformation,
+    IN ULONG Length,
+    IN FILE_INFORMATION_CLASS FileInformationClass
+    );
+
+#ifdef __cplusplus
+} // extern "C"
+#endif // __cplusplus
 namespace base {
 
 // Make sure our Whence mappings match the system headers.
@@ -273,9 +352,19 @@ File File::Duplicate() const {
 }
 
 bool File::DeleteOnClose(bool delete_on_close) {
+    NTSTATUS  Status = STATUS_SUCCESS;
+
+    IO_STATUS_BLOCK         IoStatusBlock;
+
   FILE_DISPOSITION_INFO disposition = {delete_on_close};
-  return ::SetFileInformationByHandle(GetPlatformFile(), FileDispositionInfo,
-                                      &disposition, sizeof(disposition)) != 0;
+    Status = NtSetInformationFile(
+                 GetPlatformFile(),
+                 &IoStatusBlock,
+                 &disposition,
+                 sizeof (disposition),
+                 FileDispositionInformation );
+
+  return NT_SUCCESS(Status);
 }
 
 // Static.
